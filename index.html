<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contact Profile</title>
  <!-- Import Tailwind CSS from CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      background-color: #f3f4f6;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }
    .profile-container {
      max-width: 480px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .profile-image {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      border: 4px solid white;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      object-fit: cover;
    }
    .contact-button {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    .section-title {
      font-size: 20px;
      font-weight: bold;
      text-align: center;
      margin-bottom: 16px;
    }
    .divider {
      height: 1px;
      background-color: #e5e7eb;
      margin: 4px 0;
    }
    .item-icon {
      width: 40px;
      text-align: center;
    }
    .contact-item {
      display: flex;
      align-items: center;
      padding: 12px 0;
    }
    .save-button {
      background-color: #1f2937;
      color: white;
      padding: 16px 24px;
      border-radius: 8px;
      flex-grow: 1;
      text-align: center;
      font-weight: 500;
    }
    .qr-button {
      background-color: #e5e7eb;
      color: #4b5563;
      padding: 16px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .section-container {
      border-top: 1px solid #e5e7eb;
      padding: 16px;
    }
  </style>
</head>
<body>
  <div class="profile-container">
    <!-- Profile Header -->
    <div style="padding: 24px; text-align: center;">
      <div style="margin-bottom: 16px; position: relative; margin-left: auto; margin-right: auto; width: 120px; height: 120px;">
        <div>
          <img id="profile-image" src="profile.webp" alt="Profile" class="profile-image">
        </div>
      </div>
      <h1 id="profile-name" style="font-size: 30px; font-weight: bold; margin-bottom: 4px;">Loading...</h1>
      <div id="profile-title" style="color: #4b5563; margin-bottom: 24px;">Loading...</div>
      
      <!-- Contact Buttons -->
      <div style="display: flex; justify-content: center; gap: 24px; margin-bottom: 24px;">
        <a href="#" id="phone-button" class="contact-button">
          <i class="fas fa-phone" style="color: #374151;"></i>
        </a>
        <a href="#" id="email-button" class="contact-button">
          <i class="fas fa-envelope" style="color: #374151;"></i>
        </a>
        <a href="#" id="share-button" class="contact-button">
          <i class="fas fa-share-alt" style="color: #374151;"></i>
        </a>
      </div>
    </div>

    <!-- Contact Info -->
    <div class="section-container">
      <a href="#" id="email-link" class="contact-item">
        <div class="item-icon">
          <i class="fas fa-envelope" style="color: #374151;"></i>
        </div>
        <div style="margin-left: 12px; color: #1f2937;" id="email-text">Loading...</div>
      </a>
    </div>

    <div class="section-container" style="border-top: 1px solid #e5e7eb;">
      <a href="#" id="phone-link" class="contact-item">
        <div class="item-icon">
          <i class="fas fa-phone" style="color: #374151;"></i>
        </div>
        <div style="margin-left: 12px; color: #1f2937;" id="phone-text">Loading...</div>
      </a>
    </div>

    <!-- Experience Section -->
    <div class="section-container">
      <h2 class="section-title">Experience</h2>
      <div class="divider"></div>
      
      <div id="experience-container">
        <!-- Experience items will be populated by JavaScript -->
      </div>
      
      <!-- Location -->
      <div class="contact-item" style="border-top: 1px solid #e5e7eb;">
        <div class="item-icon">
          <i class="fas fa-map-marker-alt" style="color: #374151;"></i>
        </div>
        <div style="margin-left: 12px; color: #1f2937;" id="location-text">Loading...</div>
      </div>
      
      <!-- Map -->
      <div style="margin-top: 8px; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden;" id="map-container">
        <!-- Map will be populated by JavaScript -->
      </div>
      
      <!-- Phone with country code -->
      <div class="contact-item" style="border-top: 1px solid #e5e7eb;">
        <div class="item-icon">
          <i class="fas fa-phone" style="color: #374151;"></i>
        </div>
        <div style="margin-left: 12px; color: #1f2937;" id="country-phone-text">Loading...</div>
      </div>
      
      <!-- Website -->
      <div class="contact-item" style="border-top: 1px solid #e5e7eb;">
        <div class="item-icon">
          <i class="fas fa-link" style="color: #374151;"></i>
        </div>
        <div style="margin-left: 12px; color: #1f2937;" id="website-text">Loading...</div>
      </div>
    </div>
    
    <!-- Academic Section -->
    <div class="section-container">
      <h2 class="section-title">Academic</h2>
      <div class="divider"></div>
      
      <div id="academic-container">
        <!-- Academic items will be populated by JavaScript -->
      </div>
    </div>
    
    <!-- Socials Section -->
    <div class="section-container">
      <h2 class="section-title">Socials</h2>
      <div class="divider"></div>
      
      <div id="socials-container">
        <!-- Social items will be populated by JavaScript -->
      </div>
    </div>
    
    <!-- Links Section -->
    <div class="section-container">
      <h2 class="section-title">Links</h2>
      <div class="divider"></div>
      
      <div id="links-container">
        <!-- Links items will be populated by JavaScript -->
      </div>
    </div>
    
    <!-- Save Contact Button -->
    <div style="padding: 16px; display: flex; gap: 8px;">
        <a href="#" id="save-contact-button" class="save-button" download="contact.vcf">
            Save contact
        </a>
      <button class="qr-button">
        <i class="fas fa-qrcode"></i>
      </button>
    </div>
  </div>

  <script>
    // Data loading functionality
    document.addEventListener('DOMContentLoaded', function() {
      // Fetch data from data.json
      fetch('data.json')
        .then(response => response.json())
        .then(data => {
          // Update basic profile information
          document.getElementById('profile-name').textContent = data.name;
          document.getElementById('profile-title').textContent = data.title;
          document.getElementById('email-text').textContent = data.email;
          document.getElementById('phone-text').textContent = data.phone;
          document.getElementById('location-text').textContent = data.location;
          document.getElementById('country-phone-text').textContent = data.countryPhone;
          document.getElementById('website-text').textContent = data.website;
          
          // Update links
          document.getElementById('email-link').href = 'mailto:' + data.email;
          document.getElementById('phone-link').href = 'tel:' + data.phone;
          document.getElementById('phone-button').href = 'tel:' + data.phone;
          document.getElementById('email-button').href = 'mailto:' + data.email;
          
          // Update map iframe
          const mapContainer = document.getElementById('map-container');
          mapContainer.innerHTML = `<iframe src="${data.mapEmbed}" width="100%" height="200" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>`;
          
          // Populate experience items
          const experienceContainer = document.getElementById('experience-container');
          experienceContainer.innerHTML = '';
          data.experience.forEach(exp => {
            const expItem = document.createElement('div');
            expItem.className = 'contact-item';
            expItem.innerHTML = `
              <div class="item-icon">
                <i class="fas fa-circle" style="color: #374151; font-size: 6px;"></i>
              </div>
              <div style="margin-left: 12px; color: #1f2937;">${exp}</div>
            `;
            experienceContainer.appendChild(expItem);
          });
          
          // Populate academic items
          const academicContainer = document.getElementById('academic-container');
          academicContainer.innerHTML = '';
          data.academic.forEach(item => {
            const academicItem = document.createElement('div');
            academicItem.className = 'contact-item';
            academicItem.innerHTML = `
              <div class="item-icon">
                <i class="fas fa-circle" style="color: #374151; font-size: 6px;"></i>
              </div>
              <div style="margin-left: 12px; color: #1f2937;">${item}</div>
            `;
            academicContainer.appendChild(academicItem);
          });
          
          // Populate social items
          const socialsContainer = document.getElementById('socials-container');
          socialsContainer.innerHTML = '';
          data.socials.forEach((social, index) => {
            const socialItem = document.createElement('div');
            socialItem.className = 'contact-item';
            if (index > 0) {
              socialItem.style.borderTop = '1px solid #e5e7eb';
            }
            socialItem.innerHTML = `
              <div class="item-icon">
                <i class="${social.icon}" style="color: #374151;"></i>
              </div>
              <div style="margin-left: 12px; color: #1f2937;">${social.username}</div>
            `;
            socialsContainer.appendChild(socialItem);
          });
          
          // Populate links items
          const linksContainer = document.getElementById('links-container');
          linksContainer.innerHTML = '';
          data.links.forEach((link, index) => {
            const linkItem = document.createElement('div');
            linkItem.className = 'contact-item';
            if (index > 0) {
              linkItem.style.borderTop = '1px solid #e5e7eb';
            }
            linkItem.innerHTML = `
              <div class="item-icon">
                <i class="fas fa-link" style="color: #374151;"></i>
              </div>
              <div style="margin-left: 12px; color: #1f2937;">${link}</div>
            `;
            linksContainer.appendChild(linkItem);
          });
          
          // Create vCard content
          const vCardData = `BEGIN:VCARD
          VERSION:3.0
          FN:${data.name}
          TITLE:${data.title}
          ORG:${data.experience[0] || ''}
          TEL;TYPE=CELL:${data.countryPhone}${data.phone}
          EMAIL:${data.email}
          URL:http://${data.website}
          ADR;TYPE=WORK:;;${data.location}
          NOTE:${data.title}
          ${data.socials.map(s => `X-SOCIALPROFILE;TYPE=${s.platform}:${s.username}`).join('\n')}
          END:VCARD`;

          // Create a data URL from the vCard
          const vCardBlob = new Blob([vCardData], { type: 'text/vcard' });
          const vCardURL = URL.createObjectURL(vCardBlob);
          
          // Set the download link and filename
          const saveButton = document.getElementById('save-contact-button');
          saveButton.href = vCardURL;
          saveButton.download = data.vCardName || `${data.name.replace(/\s+/g, '_').toLowerCase()}.vcf`;
        })
        .catch(error => {
          console.error('Error loading data:', error);
          alert('Failed to load profile data. Please check the console for details.');
        });

      // Optional: Share functionality for the share button
      const shareButton = document.getElementById('share-button');
      shareButton.addEventListener('click', function(e) {
        e.preventDefault();
        
        // Check if the Web Share API is available
        if (navigator.share) {
          navigator.share({
            title: 'Contact Profile',
            text: 'Contact details',
            url: window.location.href
          })
          .catch(error => console.log('Sharing failed', error));
        } else {
          // Fallback for browsers that don't support the Web Share API
          alert('Share this page: ' + window.location.href);
        }
      });
    });
  </script>
</body>
</html>